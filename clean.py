import csv

#10:frame.len
#14:frame.protocols
#18:eth.type
#20:ip.len
#22:ip.flags
#23:ip.ttl
#24:ip.proto
#25:ip.checksum
#27:ip.src
#28:ip.dst
#29:tcp.srcport
#30:tcp.dstport
#32:tcp.len
#38:tcp.hdr_len
#40:tcp.window_size_value
#41:tcp.window_size
#42:tcp.window_size_scalefactor
#46:tcp.time_relative
#47:tcp.time_delta
#48:tcp.analysis.bytes_in_flight
#49:tcp.analysis.push_bytes_sent
#57:Benign

# open the csv
records = open('subsetAllHeader.csv')

count = 0
ben = 0
mal = 0

# write to new csv file
with open('test.csv', 'w') as f:
    # skip header
    records.readline()
    # write new header
    f.write("frame_len, frame_protocols, eth_type, ip_len, ip_flags, ip_ttl, ip_proto, ip_checksum, ip_src, ip_dst, tcp_scrport, tcp_dstport, tcp_len, tcp_hdr_len, tcp_window_size_value, tcp_window_size, tcp_window_size_scalefactor, tcp_time_relative, tcp_time_delta, tcp_analysis.bytes_in_flight, tcp_analysis.push_bytes_sent, isMalware\n")

    # go through csv line by line
    for line in records:
        
        L = line.strip('\n').split(',')

        frame_proto = L[14].split(':')
        frame_proto = frame_proto[len(frame_proto)-1]
       
        keep_col = [L[10], frame_proto, L[18], L[20], L[22], L[23], L[24], L[25], L[27], L[28], L[29], L[30], L[32], L[38], L[40], L[41], L[42], L[46], L[47], L[48], L[49], L[57]]

        if '' in keep_col:
            continue

        is_mal = 0
        if keep_col[-1] == "Malware":
            keep_col[]


        row = L[10] + ', ' + frame_proto + ', ' + L[18] + ', ' + L[20] + ', ' + L[22] + ', ' + L[23] + ', ' + L[24] + ', ' + L[25] + ', ' + L[27] + ', ' + L[28] + ', ' + L[29] + ', ' + L[30] + ', ' + L[32] + ', ' + L[38] + ', ' + L[40] + ', ' + L[41] + ', ' + L[42] + ', ' + L[46] + ', ' + L[47] + ', ' + L[48] + ', ' + L[49] + ', ' + L[57] + '\n'

        f.write(row)

records.close()
