# Combine all the csv files within the current directory

import os
import csv

f = open('mod_combined.csv', 'w')

header = 'frame_len,frame_protocols,ip_len,ip_flags,ip_ttl,ip_proto,ip_src,ip_dst,tcp_srcport,tcp_dstport,tcp_len,tcp_hdr_len,tcp_flags,tcp_window_size_value,tcp_window_size,tcp_window_size_scalefactor,tcp_time_relative,tcp_time_delta,tcp_analysis_bytes_in_flight,tcp_analysis_push_bytes_sent,is_malware,malware_type,device,phase\n'

# write one header for the combined file
f.write(header)

for file in os.listdir():
    if file.endswith('.csv') and file.find('combined') == -1:

        print(f'Adding {file} to combined dataset')
        
        # open file and remove header
        records = open(file)
        records.readline()

        # write lines to new file
        for line in records:
            f.write(line)

        records.close()
f.close()
